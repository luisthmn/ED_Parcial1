#include <iostream>
#include <cstdlib>
#include <iomanip>
#include <limits>
#include <math.h>

using namespace std;

//-------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
void SumaVectores(float *Vector_1, float *Vector_2, float *VectorResultante, int dimensionVector)
{
    float *p, *q, *r;
    p = Vector_1;
    q = Vector_2;
    r = VectorResultante;

    for(int i = 0; i<=dimensionVector; i++, p++, q++, r++){
        *r = *p + *q;
    }

}
//----------------------------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
void RestaVectores( float *Vector_1, float *Vector_2, float *VectorResultante, int dimensionVector)
{
    float *p, *q, *r;
    p = Vector_1;
    q = Vector_2;
    r = VectorResultante;

    for(int i = 0; i<=dimensionVector; i++, p++, q++, r++){
        *r = *p - *q;
    }
}
//-------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
float ProductoPuntoVec(float *Vector_1 ,float *Vector_2 , int dimensionVectores)
{
    float *p, *q, ProductoPunto = 0;
    p = Vector_1;
    q = Vector_2;

    for(int i = 1; i<=dimensionVectores; i++, p++, q++){
        ProductoPunto += (*p) * (*q);
    }
    return ProductoPunto;
}
//-------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
float NormaVectores(float *Vector, int dimensionVector)
{
    float *p;
    p = Vector;
    float Sumatoria = 0, Norma = 0;

    for(int i = 0; i<dimensionVector; i++, p++){
        Sumatoria += (*p) * (*p);
    }
    Norma = sqrt(Sumatoria);

    return Norma;
}
//-------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
float AnguloVectores(float *Vector_1, float *Vector_2, int dimensionVector)
{
   float *p, *q;
   p = Vector_1;
   q = Vector_2;
   float Angulo = 0;

   float PP, N;  //Variables para producto punto y norma
   PP = ProductoPuntoVec(p ,q , dimensionVector);
   N = NormaVectores(p, dimensionVector) * NormaVectores( q, dimensionVector);

   Angulo = (acos(PP/N)) * (180/3.141592);
   return Angulo;

}
//-------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
void SumaMatrices(float *M1, float *M2, int ren, int col, float *S)
{
    float *p, *q, *r;
    p = M1;
    q = M2;
    r = S;

    for(int i=0; i< (ren * col); i++, p++, q++, r++){
            *r = *p + *q;
    }
}
//-------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
void RestaMatrices(float *M1, float *M2, int ren, int col, float *S)
{
    float *p, *q, *r;
    p = M1;
    q = M2;
    r = S;

    for(int i=0; i< (ren * col); i++, p++, q++, r++){
            *r = *p - *q;
    }
}
//----------------------------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
void MultiplicaMatrices(float *P, float *Q, float *R, int m, int n, int k)
{
    float *p1, *q1, *r1, resultado = 0;
    p1 = P, q1 = Q, r1 = R;

    for(int i = 0; i < m; i++){
        for(int j = 0; j < k ; j++, R++){
            resultado = 0;
            r1 = R;
            q1 = Q + j;
            p1 = P + i * n;
            for(int l = 0; l < n ; l++, p1++, q1 += k){
                resultado += (*p1) * (*q1);
            }
            *r1 = resultado;
        }
    }
}
//-------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
void MultiplicaMatrices2(float *P, float *Q, float *R, int m, int n, int k)
{
    float *p1, *q1, *r1;
    p1 = P, q1 = Q, r1 = R;
    float resultado = 0;

    for(int i = 0; i < k; i++){
        r1 = R + i;
        q1 = Q + i;
        for(int j = 0; j < m; j++, r1+=k){
            p1 = P + (n * j);
            resultado = 0;
            for(int L = 0; L < n; L++, p1++, q1+=k){

                resultado += (*p1) * (*q1);
            }
            *r1 = resultado;
        }
    }
}
//-------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
void ProdMatrizPorEscalar(float *M, int ren, int col, int escalar, float *S)
{
    float *p, *r;
    p = M;
    r = S;

    for(int i=1; i<= (ren* col); i++, p++, r++){
        *r= *p * escalar;
    }
}
//-------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
void Matrizporvector(float *M, float *Vector, float *VecR, int nRen, int nCol)
{
    float *p, *q, *r, resultado = 0;
    p = M;
    q = Vector;
    r = VecR;

   for(int i = 0; i < nRen; i++, VecR++){
        r = VecR;
        q = Vector;
        resultado = 0;

        for(int j = 0; j<nCol; j++, q++, p++){
            resultado += (*p) * (*q);
        }
        *r = resultado;
   }
}
//-------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
void IntercambiaRenglon(float *p, float *q, int n)
{
    float *p1, *q1;
    float a;

    p1 = p, q1 = q;

    for(int i = 0; i<n; i++, p1++, q1++){
         a = *p1;
        *p1 = *q1;
        *q1 = a;
    }
}
//-------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
float haceruno_izq_der(float *p,int n)
{
    float *p1, valor;
    p1 = p;


    valor = *p1;
    *p1 = 1;
    p1++;

    for (int i = 1; i<n; i++, p1++){
        *p1 = *p1/valor;
    }
    return valor;
}
//-------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
float haceruno_der_izq(float *p, int n)
{
    float *p1, valor;
    p1 = p + (n-1);
    valor = *p1;
    p1 = p;

    for(int i = 0; i < n; i++, p1++){
        *p1 = *p1 / valor;
    }
    return valor;
}
//-------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
float hacercero_der_izq(float *p, float *q, int n)
{
    float *p1, *q1, valor;
    p1 = p + (n-1);
    q1 = q + (n-1);
    valor = *q1;

    for(int i = 0; i < n; i++, p1--, q1--){
            *q1 -= (*p1) * valor;
    }
    return valor;
}
//-------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
float hacercero_izq_der(float *p, float *q, int n)
{
    float *p1, *q1;
    float valor;
    p1 = p;
    q1 = q;
    valor = *q1;

    for(int i = 0; i<n; i++, p1++, q1++){
        *q1 = (*q) - valor * (*p1);
    }
    return valor;
}
//-------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
void CapturaMatrizManual(float *M, int ren, int col)
{
    for(int i=1; i<= ren * col; i++, M++){
            cout << "Elemento : ";
            cin >> *M;
    }
}
//-------------------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------------------------------------
void CapturaVectorManual (float *Vector, int dimensionVector)
{
    for(int i=1; i<=dimensionVector; i++, Vector++){
        cout << "Elemento [" << i << "]: ";
        cin >> *Vector;
    }
}
//----------------------------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
void ImprimeVector (float *Vector, int dimensionVector)
{
    for(int i=1; i<=dimensionVector; i++, Vector++){
        cout << endl << *Vector;
    }
}
//----------------------------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
void ImprimeMatriz(float *M, int ren, int col)
{
    int contador = 0;
    for(int i=0; i < (ren * col); i++, M++){
        cout << *M << "  ";
        contador++;
        if(contador == col){
                cout << endl;
                contador = 0;
        }
    }
}
//----------------------------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
void IntercambiaElemento (float *e1, float *e2)
{
    float *p, *q;
    float a;

    p = e1;
    a = *e1;
    q = e2;

    *p = *q;
    *q = a;
}
//-------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
void PivotajeParcial(float *M, float *V, int n, int num)
{
    float *p, *q;
    p = M;
    q = V;

    for(int i = 1; i < n; i++){
        if(*p < *(p + n * i)){
            IntercambiaRenglon(p, p + num + (n*i), n);
            IntercambiaElemento(q, q+i);
        }
    }
}
//-------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
void PivotajeParcial2(float *p, float *q, int n, int num)
{
    float *p1, *q1;
    p1 = p + (n-1);
    q1 = q;

    for(int i = 1; i < n; i++){
        if(*p1 < *(p1 + n * i)){
            IntercambiaRenglon(p1, p1 + num + (n*i), n);
            IntercambiaElemento(q1, q1+i);
        }
    }
}
//-------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
void PivotajeParcial3(float *p, float *q, int n, int num)
{
    float *p1, *q1;
    p1 = p + (n*n-1) - (n-1);
    q1 = q + (n-1);

    for(int i = 1; i < n; i++){
        if(*p1 < *(p1 - n * i)){
            IntercambiaRenglon(p1, p1 - num - (n*i), n);
            IntercambiaElemento(q1, q1-i);
        }
    }

}
//-------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
void PivotajeParcial4(float *p, float *q, int n, int num)
{
    float *p1, *q1;
    p1 = p + (n*n-1);
    q1 = q + n - 1;

    for(int i = 1; i < n; i++){
        if(*p < *(p - n * i)){
            IntercambiaRenglon(p1, p1 - num - (n*i), n);
            IntercambiaElemento(q1, q1-i);
        }
    }
}
//-------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
void PivotajeParcialInversa(float *p, float *q, int n, int num)
{
    float *p1, *q1;
    p1 = p;
    q1 = q;

    for(int i = 1; i < n; i++){
        if(*p < *(p + n * i)){
            IntercambiaRenglon(p1, p1 + num + (n*i), n);
            IntercambiaRenglon(q1, q1 + num + (n*i), n);
        }
    }
}
//-------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
float hacerUnoMat(float *p, int n)
{
    float *p1, valor;
    p1 = p;
    valor = *p1;

    for(int i = 0; i < n; i++, p1++){
        *p1 /=valor;
    }
    return valor;
}
//-------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
float hacerCeroMat(float *p, float *q, int n)
{
    float *p1, *q1, valor;
    p1 = p;
    q1 = q;
    valor = *q1;

    for (int i = 0; i < n; i++, q1++, p1++)
    {
        *q1 -= valor * (*p1);
    }
    return valor;
}
//-------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
void hacerUnoIdent(float *q, float valor, int n)
{
    float *q1;
    q1 = q;

    for(int i = 0; i < n; i++, q1++)
    {
        *q1 /= valor;
    }
}
//-------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
void hacerCeroIdent(float *p, float *q, float valor, int n)
{
    float *p1, *q1;
    p1 = p;
    q1 = q;

    for(int i = 0; i < n; i++, q1++, p1++){
        *q1 -= (*p1) * valor;
    }
}
//-------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
void generarMatrizIdentidad(float *p, int n)
{
    float *p1;
    p1 = p;

    for(int i = 0; i < n; i++){
        for(int j = 0; j < n; j++, p1++){
            if(j == i){
                *p1 = 1;
            }
            else{
                *p1 = 0;
            }
        }
    }
}
//-------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
void hacerCeroIdentArriba(float *p, int valor, int n)
{
    float *p1;
    p1 = p;

    for(int i = 0; i < n; i++, p1++){
        *p1 = valor * (*p1  + n);
    }
}
//-------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
void Inversa (float *p, float *q, int n)         //Función complicada
{
    float *p1, *q1, valor;
    q1 = q;
    generarMatrizIdentidad(q1, n);

    for(int i = 0; i < n; i++){
        p1 = p;
        q1 = q;
        PivotajeParcialInversa(p1 + (n* i + i), q1 + (n * i) + i, n, n-i);
        valor = hacerUnoMat(p1, n-i);
        hacerUnoIdent(q1, valor, n);
        for(int j = 0; j < (n-1); j++){
            hacerCeroMat(p1, p1 + (n * (j+1)), n-i);
            hacerCeroIdent(p1, q1 + (n*(j+1)), valor, n);
        }
    }


    for(int k = 0; k < (n-1); k++){
        p1 = p + (n *n - 1) - (n * (k + 1)) -k;
        q1 = q + (n * (n-1)) - n*k;
        for(int L = 0; L < (n - 1 - k); L++, p1 -=n, q1 -=n){
            float *p1 = p;
            float valor;
            valor = *p1;
            *p1 = 0;
            hacerCeroIdentArriba(q1, valor, n);
        }
    }
}
//-------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
void Reducir (float *p, float *q, int n)
{
    float *p1, *q1, *r1;
    float valor;

    p1 = p;
    r1 = q; //r1 es un puntero apuntando al vector

    for(int i = 0; i < n; i++, p1+=n + 1){
        r1 = q + i;
        PivotajeParcial(p1, r1, n-i, i);
        q1 = p1 + n;
        *r1 /= *p1;
        valor = haceruno_izq_der(p1, n - i);

        for(int j = 0; j < n - (i+1); j++, q1 += n, r1++){
            *(r1 + 1) -= *(r1-j) * (*q1);
            valor = hacercero_izq_der(p1, q1, n - i);
        }

    }

}
//-------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
void Reducir2 (float *p, float *q, int n)
{
    float *p1, *p2, *q1, *q2, valor;
    p1 = p + (n-1);
    q1 = q;

    for(int i = 0; i < n; i++, p1+=(n-1), q1++){
        PivotajeParcial2(p1, q1, n, n-1);
        p2 = p1 + n;
        q2 = q1 + 1;
        valor = haceruno_der_izq(p1, n-i);
        *q1 /= valor;

        for(int j = 0; j < n-(i+1); j++, p2 += n, q2++){
            valor = hacercero_der_izq(p1, q1, n - i);
            *q2 -= valor * (*p1);
        }
    }
}
//-------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
void Reducir3 (float *p, float *q, int n)
{
    float *p1, *q1, *p2, *q2, valor;
    p1 = p + (n*n-1-n);
    q1 = q + (n-1);

    for(int i = 0; i < n; i++, p1-=(n-1), q--){
        PivotajeParcial(p1, q1, n, n-i);
        p2 = p1 - n;
        q2 = q1 - 1;
        valor = haceruno_izq_der(p1, n-i);
        *q1 /= valor;

        for(int j = 0; j < n- (i+1); j++, p2-=n, q2--){
            valor = hacercero_izq_der(p1, p2, n - i);
            *q2 -= valor * (*p1);
        }
    }
}
//-------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
void Reducir4 (float *p, float *q, int n)
{
    float *p1, *q1, *p2, *q2, valor;
    p1 = p + (n*n)-1;
    q1 = q + (n-1);

    for(int i =0; i < n; i++, p1-=n -1, q1--){
        PivotajeParcial4(p1, q1, n, n-i);
        p2 = p1 - n;
        q2 = q1 - 1;
        valor = haceruno_der_izq(p1, n-i);
        *q1 /= valor;

        for(int j = 0; j < n - (i+1); ++j, p2-=n, q2--){
            valor = hacercero_der_izq(p1, p2, n-i);
            *q2 = *q2 * valor * (*p1);
        }
    }
}
//-------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
void Resolver (float *p, float *q, int n)
{
    float *p1, *q1, valor;

    for(int i = 0; i < (n-1); i++){
        valor = *(q + (n-1-i));
        q1 = q;
        p1 = p + (n-1-i);
        for(int j = 0; j < (n-i-1); j++, q1++, p1 += n){
            *q1 -= valor * (*p1);
        }
    }

}
//-------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
void Resolver2(float *p, float *q, int n)
{
    float *p1, *q1, valor;
    for(int i = 0; i < n; i++){
        valor = *(q + (n-1-i));
        q1 = q;
        p1 = p + i;
        for(int j = 0; j < (n-1-i); j++, q1++, p1+=n){
            *q1 = *q1 - valor * (*p1);
        }
    }
}
//-------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
void Resolver3(float *p, float *q, int n)
{
    float *p1, *q1, valor;
    for(int i = 0; i < n-1; i++){
        valor = *(q-i);
        q1 = q + (n-1);
        p1 = p + (n*n-1-i);

        for(int j = 0; j < (n-1-i); j++, q1--, p1-=n){
            *q1 -=valor * (*p1);
        }
    }
}
//-------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
void Resolver4(float *p, float *q, int n)
{
    float *p1, *q1, valor;
    for(int i = 0; i < n; i++){
        valor = *(q-i);
        p1 = p + (n*n - (n+i));

        for(int j = 0; j < (n-1-i); j++, q1--, p1-=n){
            *q1 -= valor * (*p1);
        }
    }
}
//-------------------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------------------
